{"version":3,"sources":["src/libs/ts.js","src/components/gameobject.js","src/components/player.js","src/components/tower.js","src/game.js","src/index.js"],"names":["x","c","a","e","createShader","shaderSource","compileShader","y","h","createProgram","attachShader","linkProgram","B","d","createBuffer","bindBuffer","bufferData","TCTex","createTexture","bindTexture","texParameteri","texImage2D","width","height","TS","indexB","m","n","p","getContext","z","bufferSubData","bind","A","drawElements","E","q","ArrayBuffer","b","Float32Array","r","Uint32Array","g","Uint16Array","f","byteLength","l","k","t","C","blendFunc","enable","useProgram","getAttribLocation","enableVertexAttribArray","vertexAttribPointer","uniformMatrix4fv","getUniformLocation","activeTexture","col","bkg","F","clearColor","cls","clear","img","u","v","D","G","H","w","flush","subarray","window","TCShd","TCPrg","TCBuf","GameObject","constructor","texture","positionX","positionY","rotation","currentFrame","maxFrames","setFrame","animate","update","u0","v0","u1","v1","draw","canvas","Player","Math","PI","Tower","speed","Game","textures","gameObjects","push","kitten","i","tower","mainLoop","fps","setInterval","forEach","gameObject","requestAnimationFrame","$c","document","getElementById","innerWidth","innerHeight","kittenstex","move","dir","console","log","touchStart","addEventListener","event","touches","clientX","clientY","diff","changedTouches","ratio","abs","absRatio","hypot","mapping","ArrowUp","ArrowDown","ArrowLeft","ArrowRight","KeyW","KeyS","KeyA","KeyD","code","loadImage","src","Promise","resolve","reject","image","Image","error","name","all","Object","entries","map","then","fromEntries","catch"],"mappings":"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","file":"src.ab671872.js","sourceRoot":"..","sourcesContent":["/*\nTinySprite module (https://github.com/bitnenfer/tiny-canvas)\nDeveloped by Felipe Alfonso -> https://twitter.com/bitnenfer/\n*/\nfunction x(c,a,e){e=c.createShader(e);c.shaderSource(e,a);c.compileShader(e);return e}function y(c,a,e){var h=c.createProgram();a=x(c,a,35633);e=x(c,e,35632);c.attachShader(h,a);c.attachShader(h,e);c.linkProgram(h);return h}function B(c,a,e,h){var d=c.createBuffer();c.bindBuffer(a,d);c.bufferData(a,e,h);return d}window.TCShd=x;window.TCPrg=y;window.TCBuf=B;\nexport function TCTex(c,a,e,h){var d=c.createTexture();c.bindTexture(3553,d);c.texParameteri(3553,10242,33071);c.texParameteri(3553,10243,33071);c.texParameteri(3553,10240,9728);c.texParameteri(3553,10241,9728);c.texImage2D(3553,0,6408,6408,5121,a);c.bindTexture(3553,null);d.width=e;d.height=h;return d};\nexport function TS(c){var indexB=0,a=c.getContext(\"webgl\"),e=c.width,h=c.height,d=y(a,\"precision lowp float;\\nattribute float a;\\nattribute vec2 b,c,d,e;\\nattribute vec4 f;\\nvarying vec2 g;\\nvarying vec4 h;\\nuniform mat4 i;\\nvoid main() {\\nfloat q=cos(a);\\nfloat w=sin(a);\\ngl_Position=i*vec4(((vec2(d.x*q-d.y*w,d.x*w+d.y*q)*c)+b),1.0,1.0);\\ng=e;\\nh=f;\\n}\",\"precision lowp float;\\nvarying vec2 g;\\nvarying vec4 h;\\nuniform sampler2D j;\\nvoid main(){\\ngl_FragColor=texture2D(j,g)*h;\\n}\"),z=a.bufferSubData.bind(a),\nA=a.drawElements.bind(a),E=a.bindTexture.bind(a),q=new ArrayBuffer(1747520),b=new Float32Array(q),r=new Uint32Array(q),g=new Uint16Array(131064),f=B(a,34963,g.byteLength,35044),l=B(a,34962,q.byteLength,35048),k=0,t=null,C=null,m,n,p;a.blendFunc(770,771);a.enable(3042);a.useProgram(d);a.bindBuffer(34963,f);for(f=indexB=0;65532>f;f+=6,indexB+=4)g[f+0]=indexB,g[f+1]=indexB+1,g[f+2]=indexB+2,g[f+3]=indexB+0,g[f+4]=indexB+3,g[f+5]=indexB+1;a.bufferSubData(34963,0,g);a.bindBuffer(34962,l);g=a.getAttribLocation(d,\n\"a\");l=a.getAttribLocation(d,\"b\");f=a.getAttribLocation(d,\"c\");m=a.getAttribLocation(d,\"d\");n=a.getAttribLocation(d,\"e\");p=a.getAttribLocation(d,\"f\");a.enableVertexAttribArray(g);a.vertexAttribPointer(g,1,5126,0,40,0);a.enableVertexAttribArray(l);a.vertexAttribPointer(l,2,5126,0,40,4);a.enableVertexAttribArray(f);a.vertexAttribPointer(f,2,5126,0,40,12);a.enableVertexAttribArray(m);a.vertexAttribPointer(m,2,5126,0,40,20);a.enableVertexAttribArray(n);a.vertexAttribPointer(n,2,5126,0,40,28);a.enableVertexAttribArray(p);\na.vertexAttribPointer(p,4,5121,1,40,36);a.uniformMatrix4fv(a.getUniformLocation(d,\"i\"),0,new Float32Array([2/e,0,0,0,0,-2/h,0,0,0,0,1,1,-1,1,0,0]));a.activeTexture(33984);return C={g:a,c:c,col:4294967295,bkg:function(F,b,c){a.clearColor(F,b,c,1)},cls:function(){a.clear(16384)},img:function(a,c,d,e,f,g,h,l,u,v,m,n,p,D){var G=c+e,H=d+f;f=d+f;e=c+e;var w=C.col;if(a!=t||10922<=k+1)z(34962,0,q),A(4,6*k,5123,0),k=0,a!=t&&(t=a,E(3553,t));a=40*k;b[a++]=g;b[a++]=h;b[a++]=l;b[a++]=u;b[a++]=v;b[a++]=c;b[a++]=\nd;b[a++]=m;b[a++]=n;r[a++]=w;b[a++]=g;b[a++]=h;b[a++]=l;b[a++]=u;b[a++]=v;b[a++]=G;b[a++]=H;b[a++]=p;b[a++]=D;r[a++]=w;b[a++]=g;b[a++]=h;b[a++]=l;b[a++]=u;b[a++]=v;b[a++]=c;b[a++]=f;b[a++]=m;b[a++]=D;r[a++]=w;b[a++]=g;b[a++]=h;b[a++]=l;b[a++]=u;b[a++]=v;b[a++]=e;b[a++]=d;b[a++]=p;b[a++]=n;r[a++]=w;10922<=++k&&(z(34962,0,q),A(4,6*k,5123,0),k=0)},flush:function(){0!=k&&(z(34962,0,b.subarray(0,40*k)),A(4,6*k,5123,0),k=0)}}};","export class GameObject {\n  constructor(x, y, texture, width, height) {\n    this.positionX = x\n    this.positionY = y\n    this.width = width\n    this.height = height\n    this.rotation = 0\n    this.texture = texture\n    this.currentFrame = 0\n    this.maxFrames = this.texture.height / this.height | 0\n    this.setFrame(0, 0)\n    this.animate(10)\n  }\n\n  update() {\n    \n  }\n\n  setFrame(x, y) {\n    this.u0 = x * this.width / this.texture.width\n    this.v0 = y * this.height / this.texture.height\n    this.u1 = this.u0 + (this.width / this.texture.width)\n    this.v1 = this.v0 + (this.height / this.texture.height)\n  }\n\n  animate() {\n    this.currentFrame = (this.currentFrame + 1) % this.maxFrames\n    this.setFrame(0, this.currentFrame)\n  }\n\n  draw(canvas) {\n    canvas.img(\n      this.texture, \n      -this.width / 2,\n      -this.height / 2,\n      this.width,\n      this.height,\n      this.rotation,\n      this.positionX,\n      this.positionY,\n      1, \n      1,\n      this.u0,\n      this.v0,\n      this.u1,\n      this.v1\n    )\n  }\n}\n","import { GameObject } from \"./gameobject\"\n\nexport class Player extends GameObject {\n  constructor(x, y, texture, width, height) {\n    super(x, y, texture, width, height)\n    this.rotation = -90 * Math.PI / 180\n  }\n}\n","import { GameObject } from \"./gameobject\"\n\nexport class Tower extends GameObject {\n  constructor(x, y, texture, width, height, f) {\n    super(x, y, texture, width, height)\n    this.speed = 2\n    this.u0 = 0 / texture.width\n    this.v0 = f / texture.height\n    this.u1 = this.u0 + (width / texture.width)\n    this.v1 = this.v0 + (height / texture.height)\n  }\n\n  animate() {}\n\n  update() {\n    this.positionY += this.speed\n  }\n}\n","import { Player } from './components/player'\nimport { Tower } from './components/tower'\n\nexport class Game {\n  constructor(canvas, textures) {\n    this.canvas = canvas\n    this.gameObjects = []\n    this.gameObjects.push(\n      new Player(canvas.c.width / 4 * 3 - 32, canvas.c.height / 4 * 3, textures.kitten, 32, 32)\n    )\n    for (let i = 0; i < 500; i += 1) {\n      const tower = new Tower(canvas.c.width / 4 * 3, -i * 32 + canvas.c.height, textures.kitten, 32, 32, i % 4 * 32)\n      this.gameObjects.push(tower)\n    }\n    canvas.bkg(0.227, 0.227, 0.227)\n    this.update()\n    this.animate(5)\n    this.mainLoop()\n  }\n\n  animate(fps) {\n    setInterval(() => {\n      this.gameObjects.forEach(gameObject => {\n        gameObject.animate()\n      })\n    }, 1000 / fps)\n  }\n\n  update() {\n    this.gameObjects.forEach(gameObject => {\n      gameObject.update()\n    })\n  }\n\n  draw() {\n    this.canvas.cls()\n    this.gameObjects.forEach(gameObject => {\n      gameObject.draw(this.canvas)\n    })\n    this.canvas.flush()\n  }\n\n  mainLoop() {\n    requestAnimationFrame(this.mainLoop.bind(this))\n    this.update()\n    this.draw()\n  }\n}\n","import { TS, TCTex } from './libs/ts'\nimport kittenstex from './assets/kittens.png'\nimport { Game } from './game'\n\nconst $c = document.getElementById('game-canvas')\n\n$c.width = window.innerWidth\n$c.height = window.innerHeight\nconst canvas = TS($c)\n\nconst textures = {\n  kitten: kittenstex\n}\n\nconst move = dir => {\n  console.log(dir)\n}\n\nlet touchStart = null\n\n$c.addEventListener('touchstart', event => {\n  touchStart = {\n    x: event.touches[0].clientX,\n    y: event.touches[0].clientY\n  }\n})\n\n$c.addEventListener('touchend', event => {\n  const diff = {\n    x: event.changedTouches[0].clientX - touchStart.x,\n    y: event.changedTouches[0].clientY - touchStart.y\n  }\n  touchStart = null\n  const ratio = Math.abs(diff.x) / Math.abs(diff.y)\n  const absRatio = Math.abs(ratio)\n  const lenght = Math.hypot(diff.x, diff.y)\n  if (lenght < 50 || (absRatio > 0.9 && absRatio < 1.1)) {\n    return\n  }\n  if (absRatio > 1) {\n    if (diff.x < 0) {\n      move('left')\n    } else {\n      move('right')\n    }\n  } else {\n    if (diff.y < 0) {\n      move('up')\n    } else {\n      move('down')\n    }\n  }\n})\n\nwindow.addEventListener('keydown', event => {\n  const mapping = {\n    ArrowUp: 'up',\n    ArrowDown: 'down',\n    ArrowLeft: 'left',\n    ArrowRight: 'right',\n    KeyW: 'up',\n    KeyS: 'down',\n    KeyA: 'left',\n    KeyD: 'right',\n  }\n\n  const dir = mapping[event.code]\n  move(dir)\n})\n\nconst loadImage = src => {\n  return new Promise((resolve, reject) => {\n    const image = new Image()\n    image.addEventListener('load', () => resolve(image))\n    image.addEventListener('error', error => reject(error))\n    image.src = src\n  })\n}\n\nconst createTexture = async ([name, src]) => {\n  const image = await loadImage(src)\n  return [\n    name,\n    TCTex(canvas.g, image, image.width, image.height)\n  ]\n}\n\nPromise.all(Object.entries(textures).map(createTexture))\n.then(textures => Object.fromEntries(textures))\n.then(textures => {\n  new Game(canvas, textures)\n})\n.catch(error => {\n  console.error(error)\n})\n"]}